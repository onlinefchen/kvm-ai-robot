<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KVMARM 邮件列表 AI 总结报告</title>
    <style>
        body {
            font-family: 'Courier New', 'Courier', monospace;
            line-height: 1.5;
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 40px;
            background-color: #ffffff;
            color: #222;
        }
        .container {
            background: #ffffff;
        }
        h1 {
            font-size: 2.2em;
            font-weight: bold;
            color: #000;
            margin-bottom: 0.3em;
            text-align: center;
            border-bottom: 2px solid #000;
            padding-bottom: 15px;
        }
        h2 {
            font-size: 1.6em;
            font-weight: bold;
            color: #000;
            margin-top: 2em;
            margin-bottom: 0.6em;
            border-bottom: 1px solid #333;
            padding-bottom: 8px;
        }
        h3 {
            font-size: 1.2em;
            font-weight: bold;
            color: #111;
            margin-top: 1.5em;
            margin-bottom: 0.5em;
        }
        h4 {
            font-size: 1.05em;
            font-weight: bold;
            color: #333;
            margin-top: 1.2em;
            margin-bottom: 0.5em;
        }
        .meta-info {
            background: #f9f9f9;
            border: 1px solid #ddd;
            padding: 15px 20px;
            margin: 20px 0;
            font-size: 0.95em;
            line-height: 1.6;
        }
        .meta-info p {
            margin: 6px 0;
            color: #444;
        }
        .meta-info strong {
            color: #000;
            font-weight: bold;
        }
        .stats {
            display: table;
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            border: 1px solid #000;
        }
        .stat-card {
            display: table-cell;
            border: 1px solid #000;
            padding: 12px 15px;
            text-align: center;
            background: #fafafa;
        }
        .stat-card h3 {
            margin: 0;
            color: #000;
            font-size: 1.8em;
            font-weight: bold;
            border: none;
            padding: 0;
        }
        .stat-card p {
            margin: 5px 0 0 0;
            color: #444;
            font-size: 0.9em;
            font-weight: normal;
        }
        .category {
            margin: 30px 0;
        }
        .thread {
            margin: 25px 0;
            padding: 15px;
            background: #fafafa;
            border: 1px solid #ccc;
            page-break-inside: avoid;
        }
        .thread-header {
            margin-bottom: 12px;
            border-bottom: 1px solid #ddd;
            padding-bottom: 10px;
        }
        .thread-header h3 {
            font-size: 1.15em;
            font-weight: bold;
            color: #000;
            margin: 0;
        }
        .thread-meta {
            display: block;
            margin: 8px 0 12px 0;
            font-size: 0.9em;
            color: #555;
            font-style: italic;
        }
        .thread-meta span {
            margin-right: 15px;
        }
        .ai-summary {
            background: #fff;
            border-left: 3px solid #666;
            padding: 12px 15px;
            margin: 15px 0;
            line-height: 1.6;
            color: #222;
            font-style: italic;
        }
        .email-list {
            background: #fff;
            border: 1px solid #ccc;
            padding: 10px 15px;
            font-family: 'Courier New', 'Consolas', monospace;
            font-size: 0.88em;
            line-height: 1.5;
            overflow-x: auto;
            margin: 10px 0;
        }
        .email-item {
            margin: 4px 0;
            padding: 2px 0;
            color: #222;
        }
        .email-date {
            color: #0066cc;
            font-weight: bold;
        }
        .email-sender {
            color: #c30;
            font-weight: normal;
        }
        .email-subject {
            color: #000;
        }
        .archive-link {
            display: inline-block;
            margin: 15px 0;
            padding: 10px 20px;
            background: #333;
            color: #fff;
            text-decoration: none;
            border: 2px solid #000;
            font-weight: bold;
            transition: all 0.2s;
        }
        .archive-link:hover {
            background: #000;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>KVMARM Mailing List Analysis Report</h1>

        <div class="meta-info">
            <p><strong>Generated:</strong> 2025-10-21 20:49</p>
            <p><strong>Time Period:</strong> 2025年10月 第41周 (10/06 - 10/12)</p>
            <p><strong>Total Messages:</strong> 117 | <strong>Total Threads:</strong> 29</p>
            <p style="text-align: center;"><a href="archive.html" class="archive-link">📚 历史归档 Archive</a></p>
        </div>


        <div class="category">
            <h2>PATCH</h2>

            <div class="thread">
                <div class="thread-header">
                    <h3>[PATCH v12 00/12] KVM: guest_memfd: Add NUMA mempolicy support</h3>
                </div>

                <div class="thread-meta">
                    <span>32 messages</span>
                    <span>4 participants</span>
                    <span>Started: 2025-10-07</span>
                </div>

                <div class="ai-summary">
                    本邮件线程主要讨论了针对 KVM 的 guest_memfd 添加 NUMA 内存策略支持的补丁系列（PATCH v12 00/12）。该补丁旨在增强 KVM 在处理虚拟机内存时的 NUMA 感知能力，允许虚拟机管理程序（VMM）通过 mbind() 系统调用设置内存的 NUMA 策略，从而优化内存分配。<br><br>关键技术要点包括：<br>1. 引入了 gmem_inode 结构体来存储 NUMA 策略，取代了之前的 i_private 字段，增强了代码的可读性和可维护性。<br>2. 实现了 vm_ops 接口，允许在 mmap 操作中使用 NUMA 策略，确保内存分配遵循指定的 NUMA 策略。<br>3. 增加了自测试用例，验证了 NUMA 策略的应用及其在内存分配中的效果。<br><br>讨论的主要结论包括：<br>- 参与者一致认为通过 gmem_inode 来管理 NUMA 策略是合理的，能够提高代码的清晰度。<br>- 现有的补丁在功能上得到了认可，但仍需关注 ABI 兼容性和未来可能的扩展需求。<br>- 讨论中提到的几个问题，如如何处理未定义策略的情况，以及 cpuset 配置对内存分配的影响，仍需进一步探讨和解决。 <br><br>总体而言，该补丁系列为 KVM 的内存管理引入了更灵活的 NUMA 策略支持，提升了其在多节点系统中的性能表现。
                </div>

                <h4>Message List</h4>
                <div class="email-list">
<div class="email-item"><span class="email-date">[2025-10-07]</span> <span class="email-subject">[PATCH v12 00/12] KVM: guest_memfd: Add NUMA mempolicy support</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Sean Christopherson <span class="email-sender">&lt;seanjc@google.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-07]</span> <span class="email-subject">[PATCH v12 01/12] KVM: guest_memfd: Rename "struct kvm_gmem" to
 "struct gmem_file"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Sean Christopherson <span class="email-sender">&lt;seanjc@google.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-07]</span> <span class="email-subject">[PATCH v12 02/12] KVM: guest_memfd: Add macro to iterate over
 gmem_files for a mapping/inode</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Sean Christopherson <span class="email-sender">&lt;seanjc@google.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-07]</span> <span class="email-subject">[PATCH v12 03/12] KVM: guest_memfd: Use guest mem inodes instead of
 anonymous inodes</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Sean Christopherson <span class="email-sender">&lt;seanjc@google.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-07]</span> <span class="email-subject">[PATCH v12 04/12] KVM: guest_memfd: Add slab-allocated inode cache</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Sean Christopherson <span class="email-sender">&lt;seanjc@google.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-07]</span> <span class="email-subject">[PATCH v12 05/12] KVM: guest_memfd: Enforce NUMA mempolicy using
 shared policy</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Sean Christopherson <span class="email-sender">&lt;seanjc@google.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-07]</span> <span class="email-subject">[PATCH v12 06/12] KVM: selftests: Define wrappers for common syscalls
 to assert success</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Sean Christopherson <span class="email-sender">&lt;seanjc@google.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-07]</span> <span class="email-subject">[PATCH v12 07/12] KVM: selftests: Report stacktraces SIGBUS, SIGSEGV,
 SIGILL, and SIGFPE by default</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Sean Christopherson <span class="email-sender">&lt;seanjc@google.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-07]</span> <span class="email-subject">[PATCH v12 08/12] KVM: selftests: Add additional equivalents to
 libnuma APIs in KVM's numaif.h</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Sean Christopherson <span class="email-sender">&lt;seanjc@google.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-07]</span> <span class="email-subject">[PATCH v12 09/12] KVM: selftests: Use proper uAPI headers to pick up
 mempolicy.h definitions</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Sean Christopherson <span class="email-sender">&lt;seanjc@google.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-07]</span> <span class="email-subject">[PATCH v12 10/12] KVM: selftests: Add helpers to probe for NUMA
 support, and multi-node systems</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Sean Christopherson <span class="email-sender">&lt;seanjc@google.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-07]</span> <span class="email-subject">[PATCH v12 11/12] KVM: selftests: Add guest_memfd tests for mmap and
 NUMA policy support</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Sean Christopherson <span class="email-sender">&lt;seanjc@google.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-07]</span> <span class="email-subject">[PATCH v12 12/12] KVM: guest_memfd: Add gmem_inode.flags field
 instead of using i_private</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Sean Christopherson <span class="email-sender">&lt;seanjc@google.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-08]</span> <span class="email-subject">Re: [PATCH v12 01/12] KVM: guest_memfd: Rename "struct kvm_gmem" to
 "struct gmem_file"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Garg, Shivank <span class="email-sender">&lt;shivankg@amd.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-08]</span> <span class="email-subject">Re: [PATCH v12 02/12] KVM: guest_memfd: Add macro to iterate over
 gmem_files for a mapping/inode</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Garg, Shivank <span class="email-sender">&lt;shivankg@amd.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-09]</span> <span class="email-subject">Re: [PATCH v12 00/12] KVM: guest_memfd: Add NUMA mempolicy support</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Ackerley Tng <span class="email-sender">&lt;ackerleytng@google.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-09]</span> <span class="email-subject">Re: [PATCH v12 01/12] KVM: guest_memfd: Rename "struct kvm_gmem" to
 "struct gmem_file"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Ackerley Tng <span class="email-sender">&lt;ackerleytng@google.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-09]</span> <span class="email-subject">Re: [PATCH v12 02/12] KVM: guest_memfd: Add macro to iterate over
 gmem_files for a mapping/inode</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Ackerley Tng <span class="email-sender">&lt;ackerleytng@google.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-09]</span> <span class="email-subject">Re: [PATCH v12 04/12] KVM: guest_memfd: Add slab-allocated inode cache</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Ackerley Tng <span class="email-sender">&lt;ackerleytng@google.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-09]</span> <span class="email-subject">Re: [PATCH v12 06/12] KVM: selftests: Define wrappers for common
 syscalls to assert success</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Ackerley Tng <span class="email-sender">&lt;ackerleytng@google.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-09]</span> <span class="email-subject">Re: [PATCH v12 05/12] KVM: guest_memfd: Enforce NUMA mempolicy using
 shared policy</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Ackerley Tng <span class="email-sender">&lt;ackerleytng@google.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-09]</span> <span class="email-subject">Re: [PATCH v12 04/12] KVM: guest_memfd: Add slab-allocated inode cache</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Ackerley Tng <span class="email-sender">&lt;ackerleytng@google.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-09]</span> <span class="email-subject">Re: [PATCH v12 07/12] KVM: selftests: Report stacktraces SIGBUS,
 SIGSEGV, SIGILL, and SIGFPE by default</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Ackerley Tng <span class="email-sender">&lt;ackerleytng@google.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-09]</span> <span class="email-subject">Re: [PATCH v12 08/12] KVM: selftests: Add additional equivalents to
 libnuma APIs in KVM's numaif.h</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Ackerley Tng <span class="email-sender">&lt;ackerleytng@google.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-09]</span> <span class="email-subject">Re: [PATCH v12 11/12] KVM: selftests: Add guest_memfd tests for mmap
 and NUMA policy support</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Ackerley Tng <span class="email-sender">&lt;ackerleytng@google.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Re: [PATCH v12 00/12] KVM: guest_memfd: Add NUMA mempolicy support</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Garg, Shivank <span class="email-sender">&lt;shivankg@amd.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Re: [PATCH v12 05/12] KVM: guest_memfd: Enforce NUMA mempolicy using
 shared policy</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Garg, Shivank <span class="email-sender">&lt;shivankg@amd.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Re: [PATCH v12 01/12] KVM: guest_memfd: Rename "struct kvm_gmem" to
 "struct gmem_file"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: David Hildenbrand <span class="email-sender">&lt;david@redhat.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Re: [PATCH v12 00/12] KVM: guest_memfd: Add NUMA mempolicy support</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Ackerley Tng <span class="email-sender">&lt;ackerleytng@google.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Re: [PATCH v12 09/12] KVM: selftests: Use proper uAPI headers to pick
 up mempolicy.h definitions</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Ackerley Tng <span class="email-sender">&lt;ackerleytng@google.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Re: [PATCH v12 05/12] KVM: guest_memfd: Enforce NUMA mempolicy using
 shared policy</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Sean Christopherson <span class="email-sender">&lt;seanjc@google.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Re: [PATCH v12 05/12] KVM: guest_memfd: Enforce NUMA mempolicy using
 shared policy</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Ackerley Tng <span class="email-sender">&lt;ackerleytng@google.com&gt;</span></div>
                </div>
            </div>

            <div class="thread">
                <div class="thread-header">
                    <h3>[PATCH] KVM: arm64: Check cpu_has_spe() before initializing PMSCR_EL1 in VHE</h3>
                </div>

                <div class="thread-meta">
                    <span>9 messages</span>
                    <span>5 participants</span>
                    <span>Started: 2025-10-07</span>
                </div>

                <div class="ai-summary">
                    本邮件线程主要讨论了一个针对 KVM（Kernel-based Virtual Machine）在 arm64 架构下的补丁，内容涉及在 VHE（Virtualization Host Extensions）模式下初始化 PMSCR_EL1 寄存器时的一个问题。补丁的核心是增加对 `cpu_has_spe()` 的检查，以确保只有支持 SPE（Sampling Profiling Extension）特性的 CPU 才会进行相关的初始化，从而避免系统启动时的卡顿问题。<br><br>关键技术要点包括：<br>1. 补丁修复了 commit efad60e46057 中引入的错误，该错误导致在 VHE 模式下，PMSCR_EL1 被初始化为 0，从而导致启动失败。<br>2. 参与者讨论了在检查 SPE 可用性时，是否应仅依赖版本号，还是应检查具体的硬件实现，指出了可能存在的固件问题。<br>3. 讨论中提到，虽然补丁解决了当前的启动问题，但仍需关注固件对 SPE 的支持情况，以确保系统的稳定性和兼容性。<br><br>主要讨论结论是，尽管补丁可以解决当前问题，但仍需进一步调查固件的实现，以确保 SPE 的可用性和正确性。参与者一致认为，补丁是合理的，但需要明确其背后的逻辑和潜在的固件缺陷。
                </div>

                <h4>Message List</h4>
                <div class="email-list">
<div class="email-item"><span class="email-date">[2025-10-07]</span> <span class="email-subject">[PATCH] KVM: arm64: Check cpu_has_spe() before initializing PMSCR_EL1 in VHE</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Mukesh Ojha <span class="email-sender">&lt;mukesh.ojha@oss.qualcomm.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-07]</span> <span class="email-subject">Re: [PATCH] KVM: arm64: Check cpu_has_spe() before initializing
 PMSCR_EL1 in VHE</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Oliver Upton <span class="email-sender">&lt;oliver.upton@linux.dev&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-08]</span> <span class="email-subject">Re: [PATCH] KVM: arm64: Check cpu_has_spe() before initializing PMSCR_EL1 in VHE</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Marc Zyngier <span class="email-sender">&lt;maz@kernel.org&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-08]</span> <span class="email-subject">Re: [PATCH] KVM: arm64: Check cpu_has_spe() before initializing
 PMSCR_EL1 in VHE</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Mukesh Ojha <span class="email-sender">&lt;mukesh.ojha@oss.qualcomm.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-08]</span> <span class="email-subject">Re: [PATCH] KVM: arm64: Check cpu_has_spe() before initializing
 PMSCR_EL1 in VHE</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Leo Yan <span class="email-sender">&lt;leo.yan@arm.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-08]</span> <span class="email-subject">Re: [PATCH] KVM: arm64: Check cpu_has_spe() before initializing
 PMSCR_EL1 in VHE</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Mukesh Ojha <span class="email-sender">&lt;mukesh.ojha@oss.qualcomm.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-08]</span> <span class="email-subject">Re: [PATCH] KVM: arm64: Check cpu_has_spe() before initializing
 PMSCR_EL1 in VHE</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Leo Yan <span class="email-sender">&lt;leo.yan@arm.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-08]</span> <span class="email-subject">Re: [PATCH] KVM: arm64: Check cpu_has_spe() before initializing
 PMSCR_EL1 in VHE</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Oliver Upton <span class="email-sender">&lt;oliver.upton@linux.dev&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-09]</span> <span class="email-subject">Re: [PATCH] KVM: arm64: Check cpu_has_spe() before initializing
 PMSCR_EL1 in VHE</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Suzuki K Poulose <span class="email-sender">&lt;suzuki.poulose@arm.com&gt;</span></div>
                </div>
            </div>

            <div class="thread">
                <div class="thread-header">
                    <h3>[PATCH] arm64: Revamp HCR_EL2.E2H RES1 detection</h3>
                </div>

                <div class="thread-meta">
                    <span>7 messages</span>
                    <span>4 participants</span>
                    <span>Started: 2025-10-09</span>
                </div>

                <div class="ai-summary">
                    在本邮件线程中，讨论的主要技术问题是针对 ARM64 架构中 HCR_EL2.E2H 的 RES1 检测进行改进。当前存在两种方式来识别仅实现 FEAT_VHE 而不支持 FEAT_E2H0 的 CPU，但在某些情况下（如 Neoverse V2），虚拟机无法可靠地检测其配置。Marc Zyngier 提出了通过利用 EL1 和 EL2 之间的寄存器重映射来替代现有的 RAO/WI 测试，从而更准确地判断 CPU 的行为。<br><br>关键技术要点包括：<br>1. 识别 CPU 是否为 VHE-only 的新方法，避免了对 ID_AA64MMFR4_EL1 的依赖。<br>2. 通过写入和读取 FAR_EL1 和 FAR_EL2 寄存器来确认 CPU 的实际行为。<br>3. 该补丁能够解决 Neoverse V2 上的虚拟机问题，并为不完全遵循架构的 CPU 提供更可靠的检测手段。<br><br>讨论的主要结论是，该补丁得到了参与者的认可和测试，且有意将其提交到稳定版本中，以改善用户体验，避免虚拟机异常退出的问题。此外，参与者还讨论了将相关补丁回溯到早期内核版本的计划。
                </div>

                <h4>Message List</h4>
                <div class="email-list">
<div class="email-item"><span class="email-date">[2025-10-09]</span> <span class="email-subject">[PATCH] arm64: Revamp HCR_EL2.E2H RES1 detection</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Marc Zyngier <span class="email-sender">&lt;maz@kernel.org&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-09]</span> <span class="email-subject">Re: [PATCH] arm64: Revamp HCR_EL2.E2H RES1 detection</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Mark Rutland <span class="email-sender">&lt;mark.rutland@arm.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-09]</span> <span class="email-subject">Re: [PATCH] arm64: Revamp HCR_EL2.E2H RES1 detection</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Marc Zyngier <span class="email-sender">&lt;maz@kernel.org&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-09]</span> <span class="email-subject">Re: [PATCH] arm64: Revamp HCR_EL2.E2H RES1 detection</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Jan Kotas <span class="email-sender">&lt;jank@cadence.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-09]</span> <span class="email-subject">Re: [PATCH] arm64: Revamp HCR_EL2.E2H RES1 detection</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Oliver Upton <span class="email-sender">&lt;oliver.upton@linux.dev&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Re: [PATCH] arm64: Revamp HCR_EL2.E2H RES1 detection</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Marc Zyngier <span class="email-sender">&lt;maz@kernel.org&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Re: [PATCH] arm64: Revamp HCR_EL2.E2H RES1 detection</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Mark Rutland <span class="email-sender">&lt;mark.rutland@arm.com&gt;</span></div>
                </div>
            </div>

            <div class="thread">
                <div class="thread-header">
                    <h3>[PATCH 0/3] arm64/sysreg: Introduce Feat descriptor and generated
 ICH_VMCR_EL2 support</h3>
                </div>

                <div class="thread-meta">
                    <span>7 messages</span>
                    <span>2 participants</span>
                    <span>Started: 2025-10-07</span>
                </div>

                <div class="ai-summary">
                    本邮件讨论的主要内容是关于在 ARM64 架构下引入特征描述符（Feat descriptor）以及生成 ICH_VMCR_EL2 寄存器支持的补丁。Sascha Bischoff 提出了三个补丁，旨在通过特征描述符支持特定于功能的字段编码，进而迁移 vGIC-v3 代码以使用生成的 ICH_VMCR_EL2 定义。<br><br>关键技术要点包括：<br>1. 引入 Feat 描述符，允许系统寄存器定义根据架构特性（如 GICv3 和 GICv5）变化，使用 Feat/ElseFeat/EndFeat 结构生成特征前缀的字段编码，同时不影响传统定义。<br>2. 生成 ICH_VMCR_EL2 的描述，包括 GICv3 和 GICv5 的变体，确保一致性并减少代码重复。<br>3. 更新 KVM vGIC-v3 实现，使用生成的 ICH_VMCR_EL2 定义，确保功能行为不变。<br><br>讨论的结论是，虽然当前的实现专注于特征变化的寄存器布局，但未来可能需要考虑其他条件（如 ESR_ELx）对寄存器布局的影响。参与者 Mark Brown 提出了一些关于语法和实现复杂性的建议，强调了在设计时需要考虑未来可能的嵌套特征情况。整体上，补丁的实施为支持特征依赖的寄存器布局奠定了基础，但仍需解决一些潜在的复杂性和语法问题。
                </div>

                <h4>Message List</h4>
                <div class="email-list">
<div class="email-item"><span class="email-date">[2025-10-07]</span> <span class="email-subject">[PATCH 0/3] arm64/sysreg: Introduce Feat descriptor and generated
 ICH_VMCR_EL2 support</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Sascha Bischoff <span class="email-sender">&lt;Sascha.Bischoff@arm.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-07]</span> <span class="email-subject">[PATCH 3/3] KVM: arm64: gic-v3: Switch vGIC-v3 to use generated
 ICH_VMCR_EL2</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Sascha Bischoff <span class="email-sender">&lt;Sascha.Bischoff@arm.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-07]</span> <span class="email-subject">[PATCH 2/3] arm64/sysreg: Add ICH_VMCR_EL2</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Sascha Bischoff <span class="email-sender">&lt;Sascha.Bischoff@arm.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-07]</span> <span class="email-subject">[PATCH 1/3] arm64/sysreg: Support feature-specific fields with 'Feat'
 descriptor</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Sascha Bischoff <span class="email-sender">&lt;Sascha.Bischoff@arm.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-07]</span> <span class="email-subject">Re: [PATCH 1/3] arm64/sysreg: Support feature-specific fields with
 'Feat' descriptor</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Mark Brown <span class="email-sender">&lt;broonie@kernel.org&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-09]</span> <span class="email-subject">Re: [PATCH 1/3] arm64/sysreg: Support feature-specific fields with
 'Feat' descriptor</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Sascha Bischoff <span class="email-sender">&lt;Sascha.Bischoff@arm.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-09]</span> <span class="email-subject">Re: [PATCH 1/3] arm64/sysreg: Support feature-specific fields with
 'Feat' descriptor</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Mark Brown <span class="email-sender">&lt;broonie@kernel.org&gt;</span></div>
                </div>
            </div>

            <div class="thread">
                <div class="thread-header">
                    <h3>[PATCH v2 1/4] arm64/sysreg: Fix checks for incomplete sysreg
 definitions</h3>
                </div>

                <div class="thread-meta">
                    <span>5 messages</span>
                    <span>1 participants</span>
                    <span>Started: 2025-10-09</span>
                </div>

                <div class="ai-summary">
                    本邮件线程主要讨论了针对 ARM64 系统寄存器（sysreg）定义的几个补丁，重点是修复不完整的 sysreg 定义检查和引入条件字段编码支持。第一个补丁修正了对未定义位的检查逻辑，将其从“> 0”改为“>= 0”，以确保能够正确捕捉到位 0 未定义的情况。虽然没有实际的 sysreg 定义缺失位 0，但这一修正提高了代码的健壮性。<br><br>接下来的补丁引入了“Prefix”描述符，允许在 sysreg 定义中根据不同的特性条件生成字段编码。这一机制支持在不影响现有代码的情况下，添加特性相关的寄存器布局。最后，补丁还添加了 ICH_VMCR_EL2 寄存器的定义，并将其从手动定义迁移到生成的 sysreg 框架中，以确保一致性并减少重复。<br><br>讨论的主要结论是，这些补丁为未来的 GICv5 KVM 支持奠定了基础，尽管当前没有功能性变化，但为多种字段编码的寄存器描述提供了必要的基础设施。待解决的问题主要是确保所有相关代码能够顺利迁移到新的 sysreg 框架中。
                </div>

                <h4>Message List</h4>
                <div class="email-list">
<div class="email-item"><span class="email-date">[2025-10-09]</span> <span class="email-subject">[PATCH v2 1/4] arm64/sysreg: Fix checks for incomplete sysreg
 definitions</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Sascha Bischoff <span class="email-sender">&lt;Sascha.Bischoff@arm.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-09]</span> <span class="email-subject">[PATCH v2 0/4] arm64/sysreg: Introduce Prefix descriptor and
 generated ICH_VMCR_EL2 support</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Sascha Bischoff <span class="email-sender">&lt;Sascha.Bischoff@arm.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-09]</span> <span class="email-subject">[PATCH v2 4/4] KVM: arm64: gic-v3: Switch vGIC-v3 to use generated
 ICH_VMCR_EL2</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Sascha Bischoff <span class="email-sender">&lt;Sascha.Bischoff@arm.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-09]</span> <span class="email-subject">[PATCH v2 2/4] arm64/sysreg: Support feature-specific fields with
 'Prefix' descriptor</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Sascha Bischoff <span class="email-sender">&lt;Sascha.Bischoff@arm.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-09]</span> <span class="email-subject">[PATCH v2 3/4] arm64/sysreg: Add ICH_VMCR_EL2</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Sascha Bischoff <span class="email-sender">&lt;Sascha.Bischoff@arm.com&gt;</span></div>
                </div>
            </div>

            <div class="thread">
                <div class="thread-header">
                    <h3>[PATCH v3 9/9] KVM: selftests: Provide README.rst for KVM
 selftests runner</h3>
                </div>

                <div class="thread-meta">
                    <span>3 messages</span>
                    <span>3 participants</span>
                    <span>Started: 2025-10-10</span>
                </div>

                <div class="ai-summary">
                    本邮件线程主要讨论了针对 KVM 自测试的补丁内容，特别是提供 README.rst 文档以帮助用户理解 KVM 自测试运行器的使用。参与者们探讨了该补丁的设计目标、实现细节以及与现有 kselftest 基础设施的关系。<br><br>关键技术要点包括：<br>1. KVM 自测试运行器的设计旨在提高稳定性和可维护性，避免不同子系统之间的依赖问题。<br>2. 该运行器允许 KVM 自测试并行执行，设计上避免了对 KVM 的直接依赖，但仍然会根据 KVM 社区的需求进行定制。<br>3. 运行器是可选的，用户可以选择使用它来获得更好的测试覆盖率和执行效率。<br><br>讨论的主要结论是，尽管该运行器与 kselftest 基础设施有一些相似之处，但它提供了更灵活的配置选项和更高的测试覆盖率，适合不同层次的贡献者使用。此外，参与者同意需要在文档中进一步阐明该运行器与 kselftest 的关系，以便用户更好地理解其功能和使用场景。待解决的问题包括如何更好地整合和标记测试的并行性，以及确保 KVM 自测试的输出格式与现有标准的一致性。
                </div>

                <h4>Message List</h4>
                <div class="email-list">
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Re: [PATCH v3 9/9] KVM: selftests: Provide README.rst for KVM
 selftests runner</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Brendan Jackman <span class="email-sender">&lt;jackmanb@google.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Re: [PATCH v3 9/9] KVM: selftests: Provide README.rst for KVM
 selftests runner</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Sean Christopherson <span class="email-sender">&lt;seanjc@google.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Re: [PATCH v3 9/9] KVM: selftests: Provide README.rst for KVM
 selftests runner</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Vipin Sharma <span class="email-sender">&lt;vipinsh@google.com&gt;</span></div>
                </div>
            </div>

            <div class="thread">
                <div class="thread-header">
                    <h3>[PATCH v2 0/2] arm64: Replace __ASSEMBLY__ with __ASSEMBLER__ in headers</h3>
                </div>

                <div class="thread-meta">
                    <span>3 messages</span>
                    <span>1 participants</span>
                    <span>Started: 2025-10-10</span>
                </div>

                <div class="ai-summary">
                    本邮件讨论的主要技术问题是关于在 arm64 架构的内核头文件中，将宏 `__ASSEMBLY__` 替换为 `__ASSEMBLER__` 的补丁。当前，`__ASSEMBLY__` 仅由内核的 Makefile 定义，而 `__ASSEMBLER__` 是 GCC 和 Clang 编译器在编译汇编代码时自动定义的。使用 `__ASSEMBLER__` 可以减少用户空间和内核空间代码之间的混淆。<br><br>关键技术要点包括：<br>1. 提议的补丁分为两个部分，分别针对 uapi 和非 uapi 头文件，目的是统一使用 `__ASSEMBLER__`。<br>2. 之前针对其他架构（如 x86、parisc 等）的类似补丁已成功合并，且未收到用户空间问题的反馈。<br>3. 该补丁的修改主要是机械性的文本替换，确保了代码的一致性和可读性。<br><br>讨论的结论是，建议将该补丁合并到 arm64 的代码库中。待解决的问题主要是确保在用户空间的 Makefile 中也能正确处理这些宏定义，以避免潜在的兼容性问题。
                </div>

                <h4>Message List</h4>
                <div class="email-list">
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">[PATCH v2 0/2] arm64: Replace __ASSEMBLY__ with __ASSEMBLER__ in headers</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Thomas Huth <span class="email-sender">&lt;thuth@redhat.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">[PATCH v2 1/2] arm64: Replace __ASSEMBLY__ with __ASSEMBLER__ in uapi headers</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Thomas Huth <span class="email-sender">&lt;thuth@redhat.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">[PATCH v2 2/2] arm64: Replace __ASSEMBLY__ with __ASSEMBLER__ in non-uapi headers</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Thomas Huth <span class="email-sender">&lt;thuth@redhat.com&gt;</span></div>
                </div>
            </div>

            <div class="thread">
                <div class="thread-header">
                    <h3>[PATCH] KVM: arm64: selftests: Actually enable IRQs in vgic_lpi_stress</h3>
                </div>

                <div class="thread-meta">
                    <span>2 messages</span>
                    <span>2 participants</span>
                    <span>Started: 2025-10-07</span>
                </div>

                <div class="ai-summary">
                    本邮件线程主要讨论了一个针对 KVM（Kernel-based Virtual Machine）在 arm64 架构下的自测试补丁，具体是关于 vgic_lpi_stress 测试中 IRQ（中断请求）未启用的问题。邮件的发起者 Oliver Upton 指出，该测试在执行期间意外地将 IRQ 保持为禁用状态，尽管 ITS（中断转发系统）对 MSI（消息信号中断）的转换仍然会发生。为了确保测试的完整性，建议在测试中实际启用 LPIs（本地中断）。<br><br>关键技术要点包括：<br>1. 在 vgic_lpi_stress 测试中，增加了对 IRQ 的启用操作，以确保来访的 LPIs 能被正确处理。<br>2. 补丁内容为在 `guest_code` 函数中插入了 `local_irq_enable()` 调用。<br><br>讨论的结论是，Zenghui Yu 对该补丁进行了审核并表示认可，确认了补丁的有效性。当前没有提出待解决的问题，补丁已准备好进行合并。
                </div>

                <h4>Message List</h4>
                <div class="email-list">
<div class="email-item"><span class="email-date">[2025-10-07]</span> <span class="email-subject">[PATCH] KVM: arm64: selftests: Actually enable IRQs in vgic_lpi_stress</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Oliver Upton <span class="email-sender">&lt;oliver.upton@linux.dev&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-08]</span> <span class="email-subject">Re: [PATCH] KVM: arm64: selftests: Actually enable IRQs in
 vgic_lpi_stress</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Zenghui Yu <span class="email-sender">&lt;zenghui.yu@linux.dev&gt;</span></div>
                </div>
            </div>

            <div class="thread">
                <div class="thread-header">
                    <h3>[PATCH] KVM: arm64: selftests: Sync ID_AA64PFR1, MPIDR, CLIDR in guest</h3>
                </div>

                <div class="thread-meta">
                    <span>1 messages</span>
                    <span>1 participants</span>
                    <span>Started: 2025-10-12</span>
                </div>

                <div class="ai-summary">
                    本邮件讨论的主要技术问题是针对 KVM（Kernel-based Virtual Machine）在 arm64 架构下的自测试中，缺少对几个寄存器（ID_AA64PFR1、MPIDR 和 CLIDR）的同步处理。参与者 Zenghui Yu 提出了一项补丁，目的是确保虚拟机（guest）能够正确读取到这些寄存器的写入值。<br><br>关键技术要点包括：<br>1. 在 guest 代码中添加了对 SYS_ID_AA64PFR1_EL1、SYS_MPIDR_EL1 和 SYS_CLIDR_EL1 寄存器的同步操作，以确保这些寄存器的值在 guest 中得到正确反映。<br>2. 补丁通过在相应的代码文件中增加三行代码实现了这一功能。<br><br>讨论的结论是，补丁的提交旨在修复现有的缺失同步问题，以提升 KVM 在 arm64 架构下的稳定性和可靠性。当前的待解决问题是确保该补丁在不同环境中的兼容性和有效性。
                </div>

                <h4>Message List</h4>
                <div class="email-list">
<div class="email-item"><span class="email-date">[2025-10-12]</span> <span class="email-subject">[PATCH] KVM: arm64: selftests: Sync ID_AA64PFR1, MPIDR, CLIDR in guest</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Zenghui Yu <span class="email-sender">&lt;zenghui.yu@linux.dev&gt;</span></div>
                </div>
            </div>

            <div class="thread">
                <div class="thread-header">
                    <h3>[PATCH v7 06/12] KVM: guest_memfd: add module param for disabling
 TLB flushing</h3>
                </div>

                <div class="thread-meta">
                    <span>1 messages</span>
                    <span>1 participants</span>
                    <span>Started: 2025-10-11</span>
                </div>

                <div class="ai-summary">
                    本邮件讨论的主要技术问题是关于 KVM（Kernel-based Virtual Machine）中 guest_memfd 的 TLB（Translation Lookaside Buffer）刷新机制的优化。具体而言，参与者 Patrick Roy 和 David Hildenbrand 探讨了通过批量和延迟 TLB 刷新来提高性能的可能性。提议的方案是，在处理内存分配时，guest_memfd 可以维护一个计数器，记录直接映射的页面数量，并在每分配 512 页时进行一次 TLB 刷新。此外，为了确保在长时间没有分配的情况下也能及时刷新，建议每 5 秒强制刷新一次。<br><br>关键技术要点包括：<br>1. 批量刷新 TLB 的潜在性能提升，测试结果显示与不进行 TLB 刷新的方案相比，性能下降仅为 30%。<br>2. 结合在 fallocate() 和 write() 结束时的批量刷新可以进一步优化性能。<br><br>讨论的结论是，虽然早期的实验显示这种方法在性能上有所改善，但仍未达到实用水平，后续需要进一步的测试和优化，以确保该方案能有效提升 KVM 的性能。
                </div>

                <h4>Message List</h4>
                <div class="email-list">
<div class="email-item"><span class="email-date">[2025-10-11]</span> <span class="email-subject">Re: [PATCH v7 06/12] KVM: guest_memfd: add module param for disabling
 TLB flushing</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Patrick Roy <span class="email-sender">&lt;patrick.roy@linux.dev&gt;</span></div>
                </div>
            </div>

            <div class="thread">
                <div class="thread-header">
                    <h3>[PATCH v2] KVM: arm64: Guard PMSCR_EL1 initialization with SPE presence check</h3>
                </div>

                <div class="thread-meta">
                    <span>1 messages</span>
                    <span>1 participants</span>
                    <span>Started: 2025-10-10</span>
                </div>

                <div class="ai-summary">
                    本邮件讨论的主要技术问题是关于在 KVM 的 arm64 架构中，PMSCR_EL1 的初始化过程。具体来说，邮件指出在 VHE 模式下，提交的补丁（efad60e46057）未能在初始化 PMSCR_EL1 时进行充分的检查，导致某些平台在启动时出现系统挂起的问题。这是因为 EL3 没有将 Profiling Buffer 的访问权限委托给非安全世界，也没有在系统寄存器陷阱时重新注入 UNDEF。<br><br>为了解决这个问题，建议将 PMSCR_EL1 的初始化限制在支持统计分析扩展（FEAT_SPE）且 Profiling Buffer 在非安全 EL1 中可访问的 CPU 上。通过一个新的辅助函数 `cpu_has_spe()` 来判断这一点，从而确保初始化只影响那些已实现且可用的 SPE 的 CPU，避免在配置不当的平台上出现启动失败。<br><br>讨论的关键技术要点包括：<br>1. 引入 `cpu_has_spe()` 函数进行 SPE 支持检查。<br>2. 通过条件判断确保 PMSCR_EL1 的初始化不会影响不支持 SPE 的 CPU。<br><br>邮件的结论是，新的补丁有效地修复了之前的缺陷，确保了系统的稳定性，并且在 v2 版本中对提交日志进行了重新措辞，同时重用了现有的函数以简化代码。
                </div>

                <h4>Message List</h4>
                <div class="email-list">
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">[PATCH v2] KVM: arm64: Guard PMSCR_EL1 initialization with SPE presence check</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Mukesh Ojha <span class="email-sender">&lt;mukesh.ojha@oss.qualcomm.com&gt;</span></div>
                </div>
            </div>

            <div class="thread">
                <div class="thread-header">
                    <h3>[PATCH 2/2] KVM: arm64: selftests: Cover ID_AA64ISAR3_EL1 in
 set_id_regs</h3>
                </div>

                <div class="thread-meta">
                    <span>1 messages</span>
                    <span>1 participants</span>
                    <span>Started: 2025-10-10</span>
                </div>

                <div class="ai-summary">
                    该邮件讨论的主要技术问题是关于 KVM（Kernel-based Virtual Machine）在 arm64 架构下的自测试（selftests）补丁，特别是如何在 `set_id_regs` 函数中覆盖 `ID_AA64ISAR3_EL1` 寄存器。参与者 Zenghui Yu 提出了一个与补丁无关的观察，指出在处理虚拟机（guest）时，可能遗漏了对几个寄存器（如 `ID_AA64PFR1`、`MPIDR` 和 `CLIDR`）的同步，导致虚拟机未能正确读取到写入的值。<br><br>关键技术要点包括：<br>1. 补丁的目标是增强 KVM 对 arm64 架构下寄存器的支持。<br>2. 需要确保在虚拟机环境中，所有相关寄存器的值都能被正确同步和读取。<br><br>讨论的结论是，除了当前补丁外，还需要关注寄存器同步的问题，以确保虚拟机能够正确处理寄存器的值。这一问题仍待解决，可能需要后续的补丁或改进措施。
                </div>

                <h4>Message List</h4>
                <div class="email-list">
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Re: [PATCH 2/2] KVM: arm64: selftests: Cover ID_AA64ISAR3_EL1 in
 set_id_regs</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Zenghui Yu <span class="email-sender">&lt;zenghui.yu@linux.dev&gt;</span></div>
                </div>
            </div>

            <div class="thread">
                <div class="thread-header">
                    <h3>[PATCH v3 1/9] KVM: selftest: Create KVM selftest runner</h3>
                </div>

                <div class="thread-meta">
                    <span>1 messages</span>
                    <span>1 participants</span>
                    <span>Started: 2025-10-10</span>
                </div>

                <div class="ai-summary">
                    在这封邮件中，讨论的主要技术问题是关于 KVM（内核虚拟机）的自测试框架的补丁，具体是“创建 KVM 自测试运行器”。参与者 Vipin Sharma 提出了一个小的语法错误修正建议，指出在补丁文档中“exists”应更正为“exist”。虽然邮件中没有深入讨论补丁的具体实现细节，但可以推测该补丁旨在增强 KVM 的自测试能力，以提高虚拟化环境的稳定性和可靠性。<br><br>关键的技术要点包括：<br>1. KVM 自测试运行器的创建，可能涉及测试 KVM 功能的自动化。<br>2. 语法错误的修正，显示出对文档质量的重视。<br><br>讨论的结论是，尽管当前的讨论主要集中在语法修正上，但补丁的实施将有助于 KVM 的自测试框架的完善。待解决的问题包括如何进一步完善该补丁的功能和确保其在实际环境中的有效性。
                </div>

                <h4>Message List</h4>
                <div class="email-list">
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Re: [PATCH v3 1/9] KVM: selftest: Create KVM selftest runner</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Brendan Jackman <span class="email-sender">&lt;jackmanb@google.com&gt;</span></div>
                </div>
            </div>

            <div class="thread">
                <div class="thread-header">
                    <h3>[PATCH v5 32/44] KVM: x86/pmu: Disable interception of select PMU
 MSRs for mediated vPMUs</h3>
                </div>

                <div class="thread-meta">
                    <span>1 messages</span>
                    <span>1 participants</span>
                    <span>Started: 2025-10-09</span>
                </div>

                <div class="ai-summary">
                    在这封邮件中，主要讨论了一个关于KVM（内核虚拟机）中与性能监控单元（PMU）相关的补丁，具体是针对虚拟化环境中选择性禁用某些PMU MSR（模型特定寄存器）拦截的提议。邮件中提到的补丁编号为v5 32/44。<br><br>关键技术要点包括：<br>1. 提议中的函数名`kvm_need_pmc_intercept()`可能会误导用户，使其认为该函数用于检查特定的PMC是否被拦截。建议将其重命名为`kvm_need_global_intercept()`以更准确地反映其功能。<br>2. 该补丁旨在优化KVM的性能监控功能，特别是在使用受限的虚拟化环境中。<br><br>讨论的结论是，尽管补丁的其他部分看起来良好，但函数命名的问题需要解决，以避免用户的误解。整体来看，邮件中没有提出其他待解决的问题，主要集中在函数命名的准确性上。
                </div>

                <h4>Message List</h4>
                <div class="email-list">
<div class="email-item"><span class="email-date">[2025-10-09]</span> <span class="email-subject">Re: [PATCH v5 32/44] KVM: x86/pmu: Disable interception of select PMU
 MSRs for mediated vPMUs</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Mi, Dapeng <span class="email-sender">&lt;dapeng1.mi@linux.intel.com&gt;</span></div>
                </div>
            </div>

            <div class="thread">
                <div class="thread-header">
                    <h3>[PATCH] KVM: arm64: selftests: Allocate vcpus with correct size</h3>
                </div>

                <div class="thread-meta">
                    <span>1 messages</span>
                    <span>1 participants</span>
                    <span>Started: 2025-10-08</span>
                </div>

                <div class="ai-summary">
                    本邮件讨论的主要技术问题是针对 KVM（Kernel-based Virtual Machine）在 arm64 架构下的自测试代码中，vcpus 数组的内存分配问题。参与者 Zenghui Yu 提出了一个补丁，修正了 vcpus 数组的内存分配方式，避免了不必要的内存浪费。<br><br>关键技术要点包括：当前的代码中，vcpus 数组被错误地分配为 `nr_cpus * sizeof(struct kvm_vcpu)`，这实际上是分配了过多的内存，因为 vcpus 数组应当存储指向 `struct kvm_vcpu` 的指针，而不是整个结构体。补丁通过将分配改为 `nr_cpus * sizeof(struct kvm_vcpu *)`，有效地修正了这一问题。<br><br>讨论的结论是，该补丁已被提交并进行了必要的代码修改，确保了内存分配的准确性，提升了代码的效率和可维护性。当前没有提及待解决的问题，表明该补丁的提出和应用是一个直接的改进。
                </div>

                <h4>Message List</h4>
                <div class="email-list">
<div class="email-item"><span class="email-date">[2025-10-08]</span> <span class="email-subject">[PATCH] KVM: arm64: selftests: Allocate vcpus with correct size</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Zenghui Yu <span class="email-sender">&lt;zenghui.yu@linux.dev&gt;</span></div>
                </div>
            </div>

            <div class="thread">
                <div class="thread-header">
                    <h3>[PATCH v10 03/43] arm64: RME: Add SMC definitions for calling the
 RMM</h3>
                </div>

                <div class="thread-meta">
                    <span>1 messages</span>
                    <span>1 participants</span>
                    <span>Started: 2025-10-08</span>
                </div>

                <div class="ai-summary">
                    本邮件讨论的主要技术问题是关于 ARM64 架构下的 RME（Realm Management Extensions）中，如何为调用 RMM（Realm Management Monitor）添加 SMC（Secure Monitor Call）定义。参与者 Suzuki K Poulose 引用了 Steven Price 的观点，指出 RMM 设计采取了保守的方式，仅暴露了最基本的控制接口给主机，以管理 VGIC（Virtual Generic Interrupt Controller），旨在避免增加 RMM 的复杂性。<br><br>关键技术要点包括：当前的控制接口可能不足以让主机有效管理 Realm 的 VGIC，参与者建议可以将这一反馈传递给 RMM 规范，以便在未来的版本中进行扩展。此外，新的陷阱（traps）将被报告为“sysreg”访问，类似于已暴露的 ICC_DIR 和 ICC_SGIxR。<br><br>讨论的结论是，虽然现有的控制接口可能存在局限性，但可以通过反馈机制进行改进，未来版本有望增加更多功能。当前尚未解决的问题是如何具体定义和实现这些扩展的控制接口。
                </div>

                <h4>Message List</h4>
                <div class="email-list">
<div class="email-item"><span class="email-date">[2025-10-08]</span> <span class="email-subject">Re: [PATCH v10 03/43] arm64: RME: Add SMC definitions for calling the
 RMM</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Suzuki K Poulose <span class="email-sender">&lt;suzuki.poulose@arm.com&gt;</span></div>
                </div>
            </div>

            <div class="thread">
                <div class="thread-header">
                    <h3>[PATCH] KVM: arm64: gic-v3: Only set ICH_HCR traps for v2-on-v3 or v3
 guests</h3>
                </div>

                <div class="thread-meta">
                    <span>1 messages</span>
                    <span>1 participants</span>
                    <span>Started: 2025-10-07</span>
                </div>

                <div class="ai-summary">
                    本邮件讨论的主要技术问题是关于 KVM（Kernel-based Virtual Machine）在 ARM64 架构下对 GICv3（通用中断控制器版本3）硬件的处理，特别是如何在不同版本的虚拟机（如 GICv2 和 GICv3）上正确设置 ICH_HCR（中断控制寄存器）陷阱。<br><br>关键技术要点包括：<br>1. ICH_HCR_EL2 陷阱的使用场景：当在 GICv3 硬件上运行 GICv3 基础的虚拟机时，陷阱用于特定场景；而在 GICv2 虚拟机上，陷阱确保虚拟机只看到 GICv2 的部分。<br>2. 更新 vGIC CPU 接口状态时需要谨慎，避免错误更新导致状态损坏。<br>3. 如果虚拟机不兼容（如在 GICv3 硬件上运行 GICv2 虚拟机），应尽早退出设置过程；在 GICv3 虚拟机上则需有条件地设置陷阱。<br><br>讨论的结论是，针对不同类型的虚拟机，需在代码中实现条件判断，以确保正确配置陷阱，避免不必要的状态损坏。待解决的问题主要是如何在未来的 GICv5 虚拟机支持中进一步优化这一机制。
                </div>

                <h4>Message List</h4>
                <div class="email-list">
<div class="email-item"><span class="email-date">[2025-10-07]</span> <span class="email-subject">[PATCH] KVM: arm64: gic-v3: Only set ICH_HCR traps for v2-on-v3 or v3
 guests</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Sascha Bischoff <span class="email-sender">&lt;Sascha.Bischoff@arm.com&gt;</span></div>
                </div>
            </div>

            <div class="thread">
                <div class="thread-header">
                    <h3>[PATCH] Documentation: KVM: Update GICv3 docs for GICv5 hosts</h3>
                </div>

                <div class="thread-meta">
                    <span>1 messages</span>
                    <span>1 participants</span>
                    <span>Started: 2025-10-07</span>
                </div>

                <div class="ai-summary">
                    本邮件讨论的主要内容是关于更新 KVM 文档，以反映 GICv5 主机对 GICv3 虚拟机的支持。参与者 Sascha Bischoff 提出了一个补丁，更新了相关文档，指出 GICv5 主机可以选择性地支持 FEAT_GCIE_LEGACY 特性，从而允许在 GICv5 硬件上运行基于 GICv3 的虚拟机。<br><br>关键技术要点包括：<br>1. GICv5 主机的 FEAT_GCIE_LEGACY 特性使得其能够兼容运行 GICv3 虚拟机。<br>2. 文档更新的具体内容是修改了关于创建 GICv3 设备的说明，明确指出可以在 GICv5 主机上创建 GICv3 设备。<br><br>讨论的结论是，补丁已成功更新文档以反映新的兼容性特性，确保用户了解在 GICv5 环境中如何正确配置 GICv3 虚拟机。当前没有提到待解决的问题，表明该补丁已准备好提交。
                </div>

                <h4>Message List</h4>
                <div class="email-list">
<div class="email-item"><span class="email-date">[2025-10-07]</span> <span class="email-subject">[PATCH] Documentation: KVM: Update GICv3 docs for GICv5 hosts</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Sascha Bischoff <span class="email-sender">&lt;Sascha.Bischoff@arm.com&gt;</span></div>
                </div>
            </div>

            <div class="thread">
                <div class="thread-header">
                    <h3>[PATCH 15/34] KVM: Add KVM_CREATE_GUEST_MEMFD ioctl() for
 guest-specific backing memory</h3>
                </div>

                <div class="thread-meta">
                    <span>1 messages</span>
                    <span>1 participants</span>
                    <span>Started: 2025-10-07</span>
                </div>

                <div class="ai-summary">
                    在这封邮件中，讨论的主要技术问题是关于在 KVM 中添加 `KVM_CREATE_GUEST_MEMFD` ioctl() 接口，以支持特定于虚拟机的后备内存。Nikita Kalyazin 提出了该补丁的初步想法，并询问是否存在影响脏页日志记录（dirty logging）功能的问题。<br><br>关键的技术要点包括：<br>1. 该补丁旨在允许为虚拟机创建特定的内存文件描述符（memfd），以便更灵活地管理虚拟机的内存。<br>2. Kalyazin 认为，脏页日志记录应该能够与 guest_memfd 一起正常工作，尤其是在非 CoCo 虚拟机中。<br>3. 需要在用户空间中明确列出支持的功能，并可能需要解决 KVM 中的一些假设问题。<br><br>讨论的结论是，尽管目前没有明显的障碍，但仍需进一步验证和测试，以确保该补丁的实现不会引入新的问题，并确认脏页日志记录的兼容性。
                </div>

                <h4>Message List</h4>
                <div class="email-list">
<div class="email-item"><span class="email-date">[2025-10-07]</span> <span class="email-subject">Re: [PATCH 15/34] KVM: Add KVM_CREATE_GUEST_MEMFD ioctl() for
 guest-specific backing memory</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Sean Christopherson <span class="email-sender">&lt;seanjc@google.com&gt;</span></div>
                </div>
            </div>

            <div class="thread">
                <div class="thread-header">
                    <h3>[STABLE 5.15.y] [PATCH] KVM: arm64: Fix softirq masking in
 FPSIMD register saving sequence</h3>
                </div>

                <div class="thread-meta">
                    <span>1 messages</span>
                    <span>1 participants</span>
                    <span>Started: 2025-10-06</span>
                </div>

                <div class="ai-summary">
                    在这封邮件中，主要讨论了一个针对 KVM（Kernel-based Virtual Machine）在 arm64 架构下的补丁，内容涉及修复 FPSIMD（Floating Point SIMD）寄存器保存序列中的软中断掩码问题。该补丁旨在确保在虚拟化环境中正确处理软中断，从而提高系统的稳定性和性能。<br><br>关键技术要点包括：<br>1. FPSIMD 寄存器的保存和恢复过程在处理软中断时可能存在缺陷，影响虚拟机的运行。<br>2. 修复该问题有助于确保虚拟化环境中浮点运算的准确性和一致性。<br><br>讨论的结论是，该补丁已被确认并成功排队，准备提交到稳定版本的内核中。参与者 Greg KH 表示感谢，并确认补丁的处理进展顺利。目前没有提到其他待解决的问题，表明该补丁的修复工作已得到认可。
                </div>

                <h4>Message List</h4>
                <div class="email-list">
<div class="email-item"><span class="email-date">[2025-10-06]</span> <span class="email-subject">Re: [STABLE 5.15.y] [PATCH] KVM: arm64: Fix softirq masking in
 FPSIMD register saving sequence</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Greg KH <span class="email-sender">&lt;gregkh@linuxfoundation.org&gt;</span></div>
                </div>
            </div>
        </div>

        <div class="category">
            <h2>RFC</h2>

            <div class="thread">
                <div class="thread-header">
                    <h3>[RFC PATCH v1 11/38] KVM: arm64: CCA: register host tsm platform
 device</h3>
                </div>

                <div class="thread-meta">
                    <span>10 messages</span>
                    <span>4 participants</span>
                    <span>Started: 2025-10-10</span>
                </div>

                <div class="ai-summary">
                    本邮件讨论的主题是关于在 KVM（Kernel-based Virtual Machine）中为 ARM64 架构注册主机 TSM（Trusted Security Module）平台设备的补丁。参与者主要探讨了如何处理虚拟设备与真实硬件设备之间的关系，以及如何确保系统能够正确检测到机密计算环境。<br><br>关键技术要点包括：<br>1. 讨论了“虚拟设备”（faux device）与“辅助设备”（auxiliary device）的区别，强调虚拟设备不应与真实驱动绑定。<br>2. 提到平台固件提供的 ARM SMC 接口，及其在 TSM 子系统中的应用，如何通过 SMC 调用加载驱动。<br>3. 讨论了 systemd 如何检测机密虚拟机（CVM），并指出当前的实现可能会导致不必要的复杂性。<br><br>主要讨论结论是，参与者一致认为不应滥用平台设备来表示虚拟设备，建议创建更合适的 sysfs 接口来处理相关信息。此外，系统的早期指示机制需要改进，以避免对现有 ABI 的依赖，确保未来的兼容性和可维护性。待解决的问题包括如何在不影响现有功能的情况下，优化设备注册和检测逻辑。
                </div>

                <h4>Message List</h4>
                <div class="email-list">
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Re: [RFC PATCH v1 11/38] KVM: arm64: CCA: register host tsm platform
 device</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Jeremy Linton <span class="email-sender">&lt;jeremy.linton@arm.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Re: [RFC PATCH v1 11/38] KVM: arm64: CCA: register host tsm platform
 device</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Greg KH <span class="email-sender">&lt;gregkh@linuxfoundation.org&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Re: [RFC PATCH v1 11/38] KVM: arm64: CCA: register host tsm platform
 device</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Jason Gunthorpe <span class="email-sender">&lt;jgg@ziepe.ca&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Re: [RFC PATCH v1 11/38] KVM: arm64: CCA: register host tsm platform
 device</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Jeremy Linton <span class="email-sender">&lt;jeremy.linton@arm.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Re: [RFC PATCH v1 11/38] KVM: arm64: CCA: register host tsm platform
 device</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Jeremy Linton <span class="email-sender">&lt;jeremy.linton@arm.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Re: [RFC PATCH v1 11/38] KVM: arm64: CCA: register host tsm platform
 device</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Jason Gunthorpe <span class="email-sender">&lt;jgg@ziepe.ca&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Re: [RFC PATCH v1 11/38] KVM: arm64: CCA: register host tsm platform
 device</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Greg KH <span class="email-sender">&lt;gregkh@linuxfoundation.org&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Re: [RFC PATCH v1 11/38] KVM: arm64: CCA: register host tsm platform
 device</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Jeremy Linton <span class="email-sender">&lt;jeremy.linton@arm.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Re: [RFC PATCH v1 11/38] KVM: arm64: CCA: register host tsm platform
 device</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: dan.j.williams <span class="email-sender">&lt;dan.j.williams@intel.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Re: [RFC PATCH v1 11/38] KVM: arm64: CCA: register host tsm platform
 device</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Jason Gunthorpe <span class="email-sender">&lt;jgg@ziepe.ca&gt;</span></div>
                </div>
            </div>

            <div class="thread">
                <div class="thread-header">
                    <h3>[RFC PATCH v1 11/38] KVM: arm64: CCA: register host tsm
 platform device</h3>
                </div>

                <div class="thread-meta">
                    <span>1 messages</span>
                    <span>1 participants</span>
                    <span>Started: 2025-10-09</span>
                </div>

                <div class="ai-summary">
                    该邮件讨论的主要技术问题是关于在 KVM（Kernel-based Virtual Machine）中实现 ARM64 架构的 CCA（Cache Coherent Accelerator）时，如何自动加载主机和客人 TSM（Transaction Synchronization Mechanism）驱动程序。参与者 Aneesh Kumar K.V. 提到，在切换到 faux_device 模型后，遇到了如何根据设备分配特性自动加载驱动的问题。<br><br>关键技术要点包括：<br>1. 设备分配特性对驱动程序加载的影响。<br>2. 之前的平台设备模型提供了一个清晰的抽象，使得驱动程序的自动加载变得简单。<br><br>讨论的结论是，目前的 faux_device 模型在自动加载驱动方面存在一定的困难，需要进一步探索如何改进这一机制，以恢复之前平台设备模型的便利性。待解决的问题是如何在新的模型下实现驱动程序的自动加载功能。
                </div>

                <h4>Message List</h4>
                <div class="email-list">
<div class="email-item"><span class="email-date">[2025-10-09]</span> <span class="email-subject">Re: [RFC PATCH v1 11/38] KVM: arm64: CCA: register host tsm
 platform device</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Aneesh Kumar K.V <span class="email-sender">&lt;aneesh.kumar@kernel.org&gt;</span></div>
                </div>
            </div>
        </div>

        <div class="category">
            <h2>Bug Report</h2>

            <div class="thread">
                <div class="thread-header">
                    <h3>Saving and restoring state of a KVM VM using GICv2 fails</h3>
                </div>

                <div class="thread-meta">
                    <span>1 messages</span>
                    <span>1 participants</span>
                    <span>Started: 2025-10-10</span>
                </div>

                <div class="ai-summary">
                    该邮件讨论了在使用 GICv2 的 KVM 虚拟机中保存和恢复状态时遇到的问题。参与者 Peter Maydell 发现，虽然虚拟机的运行和状态保存正常，但在尝试重新加载状态时失败，具体错误信息涉及无法设置寄存器 ID_PFR1_EL1 的值，导致 KVM 操作失败。<br><br>关键技术要点包括：在状态保存过程中，内核在 kvm_finalize_sys_regs() 函数中仅清除了 idreg 的 GIC 字段。由于状态保存发生在虚拟 CPU 运行后，因此保存的数据中 GIC 字段的值为 0。而在加载状态时，新的虚拟机尚未运行，内核仍认为 GIC 字段应为 1，从而导致 KVM_SET_ONE_REG 操作失败。<br><br>讨论的结论是，该问题在 aarch32 和 aarch64 客户端上均存在，尚未测试在仅支持 64 位 EL1 的主机上是否会发生此问题。未来需要进一步探讨是否需要对 ID_AA64PFR0_EL1.GIC 的写入进行灵活处理，以解决此问题。
                </div>

                <h4>Message List</h4>
                <div class="email-list">
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Saving and restoring state of a KVM VM using GICv2 fails</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Peter Maydell <span class="email-sender">&lt;peter.maydell@linaro.org&gt;</span></div>
                </div>
            </div>
        </div>

        <div class="category">
            <h2>Discussion</h2>

            <div class="thread">
                <div class="thread-header">
                    <h3>KVM NV + SVE host OS warning</h3>
                </div>

                <div class="thread-meta">
                    <span>13 messages</span>
                    <span>3 participants</span>
                    <span>Started: 2025-10-07</span>
                </div>

                <div class="ai-summary">
                    在这次邮件讨论中，主要聚焦于KVM（Kernel-based Virtual Machine）在处理SVE（Scalable Vector Extension）和NV（Non-virtualized）情况下的警告问题。参与者Jan Kotas首先测试了一个补丁，虽然修复了错误信息，但导致来宾操作系统无法启动。经过进一步调试，发现问题与寄存器CPTR_EL2的值有关，导致访问ZCR_EL2时发生异常。<br><br>Oliver Upton和Marc Zyngier参与了讨论，提出了不同的技术要点，指出在没有FEAT_FGT的CPU上，VHE（Virtualization Host Extensions）来宾无法正常工作。Marc建议通过修改来宾的代码来解决此问题，并提供了补丁。Jan在应用补丁后，确认来宾操作系统能够成功启动，并正确初始化SVE。<br><br>讨论的结论是，当前的硬件限制导致无法在某些旧设备上运行VHE来宾，Marc计划发布补丁以禁止在这些设备上运行VHE来宾。整体来看，虽然问题得到了一定程度的解决，但仍存在硬件兼容性和虚拟化功能的限制，需进一步探讨和解决。
                </div>

                <h4>Message List</h4>
                <div class="email-list">
<div class="email-item"><span class="email-date">[2025-10-07]</span> <span class="email-subject">Re: KVM NV + SVE host OS warning</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Jan Kotas <span class="email-sender">&lt;jank@cadence.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-07]</span> <span class="email-subject">Re: KVM NV + SVE host OS warning</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Oliver Upton <span class="email-sender">&lt;oliver.upton@linux.dev&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-08]</span> <span class="email-subject">Re: KVM NV + SVE host OS warning</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Jan Kotas <span class="email-sender">&lt;jank@cadence.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-08]</span> <span class="email-subject">Re: KVM NV + SVE host OS warning</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Jan Kotas <span class="email-sender">&lt;jank@cadence.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-08]</span> <span class="email-subject">Re: KVM NV + SVE host OS warning</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Marc Zyngier <span class="email-sender">&lt;maz@kernel.org&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-08]</span> <span class="email-subject">Re: KVM NV + SVE host OS warning</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Jan Kotas <span class="email-sender">&lt;jank@cadence.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-08]</span> <span class="email-subject">Re: KVM NV + SVE host OS warning</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Marc Zyngier <span class="email-sender">&lt;maz@kernel.org&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-08]</span> <span class="email-subject">Re: KVM NV + SVE host OS warning</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Jan Kotas <span class="email-sender">&lt;jank@cadence.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-08]</span> <span class="email-subject">Re: KVM NV + SVE host OS warning</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Marc Zyngier <span class="email-sender">&lt;maz@kernel.org&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-09]</span> <span class="email-subject">Re: KVM NV + SVE host OS warning</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Jan Kotas <span class="email-sender">&lt;jank@cadence.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-09]</span> <span class="email-subject">Re: KVM NV + SVE host OS warning</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Marc Zyngier <span class="email-sender">&lt;maz@kernel.org&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-09]</span> <span class="email-subject">Re: KVM NV + SVE host OS warning</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Jan Kotas <span class="email-sender">&lt;jank@cadence.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-09]</span> <span class="email-subject">Re: KVM NV + SVE host OS warning</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Marc Zyngier <span class="email-sender">&lt;maz@kernel.org&gt;</span></div>
                </div>
            </div>

            <div class="thread">
                <div class="thread-header">
                    <h3>[kvm-unit-tests PATCH v2 2/4] x86: Better backtraces for leaf
 functions</h3>
                </div>

                <div class="thread-meta">
                    <span>1 messages</span>
                    <span>1 participants</span>
                    <span>Started: 2025-10-10</span>
                </div>

                <div class="ai-summary">
                    本邮件讨论的主要技术问题是关于针对 x86 架构的 KVM 单元测试中的补丁，旨在改善叶子函数的回溯信息。参与者 Mathias Krause 请求 Paolo 对该补丁进行评论，以便能够推动 ARM 和 AArch64 的相关修复工作不再受阻，并希望最终能够将这一系列补丁合并。<br><br>关键技术要点包括：<br>1. 补丁的目标是优化 x86 叶子函数的回溯，提升调试和错误追踪的效率。<br>2. 该补丁可能对 ARM 和 AArch64 的修复工作有直接影响，表明不同架构之间的补丁开发存在相互依赖性。<br><br>讨论的主要结论是，Mathias 希望能够尽快获得 Paolo 的反馈，以便推动后续的修复工作，并最终实现补丁的合并。当前的待解决问题是如何加快评论和合并过程，以避免对其他架构修复的延误。
                </div>

                <h4>Message List</h4>
                <div class="email-list">
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Re: [kvm-unit-tests PATCH v2 2/4] x86: Better backtraces for leaf
 functions</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Mathias Krause <span class="email-sender">&lt;minipli@grsecurity.net&gt;</span></div>
                </div>
            </div>
        </div>

        <div class="category">
            <h2>Other</h2>

            <div class="thread">
                <div class="thread-header">
                    <h3>HCR_EL2 GET_ONE_REG value difference</h3>
                </div>

                <div class="thread-meta">
                    <span>8 messages</span>
                    <span>2 participants</span>
                    <span>Started: 2025-10-10</span>
                </div>

                <div class="ai-summary">
                    在此次邮件讨论中，主要关注的是HCR_EL2寄存器的值差异问题。参与者Jan Kotas在调试过程中发现，通过KVM_GET_ONE_REG获取的HCR_EL2值与在虚拟机中执行MRS指令后得到的值不一致，分别为0x30480000000和0x100030080000000。他对此表示疑惑，并询问是否存在访问仿真寄存器时遗漏的内容。<br><br>Marc Zyngier回应指出，GET_ONE_REG返回的是经过处理的寄存器视图，应用了特定的掩码和约束，而虚拟机可以随意写入HCR_EL2寄存器，尽管这些写入在未执行返回到EL1时不会产生效果。他强调了这种“净化”视图的必要性，以防止从KVM中获取错误数据。<br><br>讨论的关键要点包括：<br>1. GET_ONE_REG的设计目的是提供架构上正确的信息，以便在不同机器之间恢复。<br>2. 虚拟机对寄存器的写入可能与KVM的解释存在差异，这种差异在调试时是有价值的。<br><br>最终，双方达成共识，认为当前的行为是合理且期望的，并建议在内核文档中增加关于寄存器净化的说明，以帮助开发者更好地理解这一机制。
                </div>

                <h4>Message List</h4>
                <div class="email-list">
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">HCR_EL2 GET_ONE_REG value difference</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Jan Kotas <span class="email-sender">&lt;jank@cadence.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Re: HCR_EL2 GET_ONE_REG value difference</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Marc Zyngier <span class="email-sender">&lt;maz@kernel.org&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Re: HCR_EL2 GET_ONE_REG value difference</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Jan Kotas <span class="email-sender">&lt;jank@cadence.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Re: HCR_EL2 GET_ONE_REG value difference</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Marc Zyngier <span class="email-sender">&lt;maz@kernel.org&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Re: HCR_EL2 GET_ONE_REG value difference</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Jan Kotas <span class="email-sender">&lt;jank@cadence.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Re: HCR_EL2 GET_ONE_REG value difference</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Marc Zyngier <span class="email-sender">&lt;maz@kernel.org&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Re: HCR_EL2 GET_ONE_REG value difference</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Jan Kotas <span class="email-sender">&lt;jank@cadence.com&gt;</span></div>
<div class="email-item"><span class="email-date">[2025-10-10]</span> <span class="email-subject">Re: HCR_EL2 GET_ONE_REG value difference</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: Marc Zyngier <span class="email-sender">&lt;maz@kernel.org&gt;</span></div>
                </div>
            </div>

            <div class="thread">
                <div class="thread-header">
                    <h3>Patch "KVM: arm64: Fix softirq masking in FPSIMD register saving sequence" has been added to the 6.6-stable tree</h3>
                </div>

                <div class="thread-meta">
                    <span>1 messages</span>
                    <span>1 participants</span>
                    <span>Started: 2025-10-06</span>
                </div>

                <div class="ai-summary">
                    本邮件讨论的主要技术问题是针对 KVM（Kernel-based Virtual Machine）在 arm64 架构中处理 FPSIMD（Floating Point SIMD）寄存器保存序列时的软中断（softirq）屏蔽问题。补丁标题为“Fix softirq masking in FPSIMD register saving sequence”，已被添加至 6.6-stable 树。<br><br>关键技术要点包括：之前的补丁修复了因错误回溯导致的内核 BUG，但在重新启用软中断时可能导致死锁，因为待处理的软中断在持有锁的情况下被处理。为了解决这一问题，补丁通过在保存 FPSIMD 寄存器时禁用硬中断（hardirq）来避免潜在的死锁情况。<br><br>讨论的主要结论是，该补丁已被确认并添加至稳定树，参与者未提出反对意见。补丁的实施旨在进一步提升系统的稳定性和可靠性，解决了之前补丁引发的新问题。待解决的问题主要是确保在未来的版本中持续监控此类问题的发生，以避免类似的死锁情况。
                </div>

                <h4>Message List</h4>
                <div class="email-list">
<div class="email-item"><span class="email-date">[2025-10-06]</span> <span class="email-subject">Patch "KVM: arm64: Fix softirq masking in FPSIMD register saving sequence" has been added to the 6.6-stable tree</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: gregkh <span class="email-sender">&lt;gregkh@linuxfoundation.org&gt;</span></div>
                </div>
            </div>

            <div class="thread">
                <div class="thread-header">
                    <h3>Patch "KVM: arm64: Fix softirq masking in FPSIMD register saving sequence" has been added to the 6.1-stable tree</h3>
                </div>

                <div class="thread-meta">
                    <span>1 messages</span>
                    <span>1 participants</span>
                    <span>Started: 2025-10-06</span>
                </div>

                <div class="ai-summary">
                    本邮件讨论的主要技术问题是针对 KVM（Kernel-based Virtual Machine）在 arm64 架构下，FPSIMD（Floating Point SIMD）寄存器保存序列中的软中断屏蔽问题。Will Deacon 提出的补丁旨在修复由于不当的软中断处理导致的死锁问题。<br><br>关键技术要点包括：<br>1. 之前的补丁（8f4dc4e54eed）修复了因错误回溯导致的内核 BUG，但在重新启用软中断时可能会导致死锁。<br>2. 新补丁通过在保存 FPSIMD 寄存器时禁用硬中断，进一步解决了潜在的锁竞争问题，从而避免了在持有锁的情况下处理待处理的软中断。<br><br>讨论的结论是，该补丁已被添加到 6.1-stable 树中，参与者被邀请提出任何反对意见。当前的补丁已解决了之前补丁引发的死锁问题，但仍需关注可能的其他潜在问题。
                </div>

                <h4>Message List</h4>
                <div class="email-list">
<div class="email-item"><span class="email-date">[2025-10-06]</span> <span class="email-subject">Patch "KVM: arm64: Fix softirq masking in FPSIMD register saving sequence" has been added to the 6.1-stable tree</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: gregkh <span class="email-sender">&lt;gregkh@linuxfoundation.org&gt;</span></div>
                </div>
            </div>

            <div class="thread">
                <div class="thread-header">
                    <h3>Patch "KVM: arm64: Fix softirq masking in FPSIMD register saving sequence" has been added to the 5.15-stable tree</h3>
                </div>

                <div class="thread-meta">
                    <span>1 messages</span>
                    <span>1 participants</span>
                    <span>Started: 2025-10-06</span>
                </div>

                <div class="ai-summary">
                    本邮件讨论的主要技术问题是关于修复 KVM（Kernel-based Virtual Machine）在 arm64 架构下 FPSIMD（Floating Point SIMD）寄存器保存序列中的软中断屏蔽问题。补丁标题为“Fix softirq masking in FPSIMD register saving sequence”，已被添加到 5.15-stable 树中。<br><br>关键技术要点包括：之前的补丁修复了由于错误回溯导致的内核 BUG，但在重新启用软中断时可能会导致死锁，尤其是在持有锁的情况下处理待处理的软中断。为了解决这一问题，新的补丁在保存 FPSIMD 寄存器时，除了禁用软中断外，还禁用了硬中断，以避免在处理软中断时发生锁的递归。<br><br>讨论的主要结论是，该补丁已被确认并添加到稳定版本中，参与者没有提出反对意见。待解决的问题是，进一步验证该补丁在不同环境下的稳定性和性能影响。
                </div>

                <h4>Message List</h4>
                <div class="email-list">
<div class="email-item"><span class="email-date">[2025-10-06]</span> <span class="email-subject">Patch "KVM: arm64: Fix softirq masking in FPSIMD register saving sequence" has been added to the 5.15-stable tree</span><br>&nbsp;&nbsp;&nbsp;&nbsp;Author: gregkh <span class="email-sender">&lt;gregkh@linuxfoundation.org&gt;</span></div>
                </div>
            </div>
        </div>

    </div>
</body>
</html>
